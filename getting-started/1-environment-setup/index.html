
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://firecrackersharp.github.io/getting-started/1-environment-setup/">
      
      
        <link rel="prev" href="../..">
      
      
        <link rel="next" href="../2-installing-the-sdk/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.27">
    
    
      
        <title>Environment setup - FirecrackerSharp</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6543a935.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#environment-setup" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="FirecrackerSharp" class="md-header__button md-logo" aria-label="FirecrackerSharp" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            FirecrackerSharp
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Environment setup
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="FirecrackerSharp" class="md-nav__button md-logo" aria-label="FirecrackerSharp" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    FirecrackerSharp
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Getting started
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Environment setup
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Environment setup
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#about-firecrackersharps-hosts" class="md-nav__link">
    <span class="md-ellipsis">
      About FirecrackerSharp's hosts
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-a-linux-desktop-with-hardware-virtualization" class="md-nav__link">
    <span class="md-ellipsis">
      1. A Linux desktop with hardware virtualization
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-a-linux-vm" class="md-nav__link">
    <span class="md-ellipsis">
      2. A Linux VM
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-a-linux-bare-metal-server" class="md-nav__link">
    <span class="md-ellipsis">
      3. A Linux bare metal server
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-wsl2-with-nested-virtualization-and-ssh" class="md-nav__link">
    <span class="md-ellipsis">
      4. WSL2 with nested virtualization and SSH
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../2-installing-the-sdk/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installing the SDK
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3-creating-a-basic-app/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Creating a basic app
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#about-firecrackersharps-hosts" class="md-nav__link">
    <span class="md-ellipsis">
      About FirecrackerSharp's hosts
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-a-linux-desktop-with-hardware-virtualization" class="md-nav__link">
    <span class="md-ellipsis">
      1. A Linux desktop with hardware virtualization
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-a-linux-vm" class="md-nav__link">
    <span class="md-ellipsis">
      2. A Linux VM
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-a-linux-bare-metal-server" class="md-nav__link">
    <span class="md-ellipsis">
      3. A Linux bare metal server
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-wsl2-with-nested-virtualization-and-ssh" class="md-nav__link">
    <span class="md-ellipsis">
      4. WSL2 with nested virtualization and SSH
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="environment-setup">Environment setup</h1>
<h2 id="about-firecrackersharps-hosts">About FirecrackerSharp's hosts</h2>
<p>Firecracker is a highly performant hypervisor, however it is <strong>Linux-only and relies on KVM</strong>, a Linux kernel-exclusive module for virtualization.</p>
<p>FirecrackerSharp, unlike any other Firecracker SDK, allows you to use virtual hosts <strong>other than a Linux desktop/server</strong>. This is implemented via a VM host abstraction that has several implementations:</p>
<ul>
<li>The local host (<code>FirecrackerSharp.Host.Local</code> on NuGet), this uses a Linux desktop/server without any layers of indirection. Prefer to use this in production in all possible cases, as it's (understandably) the most resilient virtual host there is.</li>
<li>The SSH host (<code>FirecrackerSharp.Host.Ssh</code> on NuGet), this connects to a remote Linux server over SSH (using <a href="https://github.com/sshnet/SSH.NET">SSH.NET</a>), uses its filesystem over SFTP and runs commands (or virtual terminals) over SSH.</li>
</ul>
<p>In the future, more hosts are planned (such as a Docker/Podman rootful container host).</p>
<p>Using these hosts, here are the most common ways to configure your environment:</p>
<h2 id="1-a-linux-desktop-with-hardware-virtualization">1. A Linux desktop with hardware virtualization</h2>
<p>This is the setup the developers of FirecrackerSharp use, and it's the one we <strong>highly recommend</strong> if using Linux for .NET development isn't a severe issue (considering that all of .NET is cross-platform and there are better IDE options than Visual Studio, using Linux would not be a problem).</p>
<p>When possible, try to <strong>adhere to <a href="https://github.com/firecracker-microvm/firecracker/blob/main/docs/kernel-policy.md">Firecracker's supported host and guest kernels</a></strong>. While it's absolutely possible to run it on, for example, the 6.9 host Linux kernel instead of the latest supported 6.1, it may cause some issues the SDK can't deal with.</p>
<ol>
<li>Enable virtualization in your BIOS, refer to the instructions of your BIOS's manufacturer and the type of your CPU to see which option to use, then reboot.</li>
<li>Install KVM to your Linux distribution. The easiest route would be to install QEMU alongside it. Follow your distribution's documentation on how to install QEMU, then reboot.</li>
<li>Verify you've installed KVM by running: <code>lsmod | grep kvm</code>. The output should contain something like <code>kvm_amd</code> or <code>kvm_intel</code> or just <code>kvm</code> for you to be sure that KVM is enabled.</li>
<li>Gain access to KVM as your rootless user (running the jailer will still require the <strong>root password</strong>, however the SDK supports escalation of privileges).<ul>
<li>For access managed through an access control list: <code>sudo setfacl -m u:${USER}:rw /dev/kvm</code></li>
<li>For access managed through a kvm group: <code>[ $(stat -c "%G" /dev/kvm) = kvm ] &amp;&amp; sudo usermod -aG kvm ${USER} &amp;&amp; echo "Access granted."</code></li>
</ul>
</li>
<li>Verify you have KVM access via <code>[ -r /dev/kvm ] &amp;&amp; [ -w /dev/kvm ] &amp;&amp; echo "OK" || echo "FAIL"</code>.</li>
</ol>
<p>Now you should be good to go! Firecracker doesn't depend on any particular Linux distribution, but it's most often used in either Debian and Ubuntu for the 6.1 host kernel.</p>
<h2 id="2-a-linux-vm">2. A Linux VM</h2>
<p>Here, you will need to create a virtual machine running Linux (preferably Debian, since it uses the 6.1 kernel).</p>
<p>On Windows, use Hyper-V, VMWare or VirtualBox. On Linux, simply install QEMU and virt-manager to create the virtual machine.</p>
<p><em>On a Linux host</em>, <strong>ensure the VM is on a bridge network interface</strong>. Then, run <code>ip addr</code> to get its address on your local network and install SSH. For different distributions, the process will vary, for Debian use the following instructions:</p>
<ol>
<li><code>sudo apt-get install -y openssh-server</code></li>
<li>Edit <code>/etc/ssh/sshd_config</code> and set <code>PermitRootLogin yes</code> so you that you can log into the root account with the root password</li>
<li><code>sudo systemctl enable ssh</code></li>
<li><code>sudo systemctl restart ssh</code></li>
<li>Go into your router's DHCP configuration and give the VM's local IP a static lease</li>
</ol>
<p><em>On a Windows host</em>, follow the instructions on how to assign a static local IP to your VM, then analogously install SSH inside the VM.</p>
<p>After installing the VM, <strong>enable nested virtualization for the VM</strong> so that it has KVM access. This will depend on which hypervisor you're using. Then, run <code>lsmod | grep kvm</code> to ensure KVM is accessible inside the VM.</p>
<h2 id="3-a-linux-bare-metal-server">3. A Linux bare metal server</h2>
<p>If it's your own hardware:</p>
<ol>
<li>Find the server's IP via <code>ip addr</code></li>
<li>Give it a static DHCP lease through the router</li>
<li>Install an SSH server like shown in section 2</li>
<li>Enable virtualization, install KVM like in preceding sections</li>
</ol>
<p>If you're using a cloud provider, <a href="https://github.com/firecracker-microvm/firecracker/blob/main/docs/dev-machine-setup.md#cloud">refer to Firecracker's development team's recommendations</a>. It'll cost a fair amount to get a bare metal server in the cloud, but it's generally worth it if you can.</p>
<h2 id="4-wsl2-with-nested-virtualization-and-ssh">4. WSL2 with nested virtualization and SSH</h2>
<p><strong>Warning:</strong> WSL is a pretty specific type of Linux VM and you may encounter issues using it for nested virtualization you wouldn't have with a conventional VM made in Hyper-V, VirtualBox or VMWare. If possible, opt for a traditional VM instead when running Windows. The WSL + SSH approach hasn't been thoroughly tested and we don't provide official support for it.</p>
<p>Follow the instructions on how to set up WSL2, enable KVM nested virtualization, and then install SSH in it. More detailed instructions will be added later.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.instant.progress", "navigation.sections"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.ad660dcc.min.js"></script>
      
    
  </body>
</html>